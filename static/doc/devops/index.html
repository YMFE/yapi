<html><head><meta charSet="UTF-8"/><meta content="text/html; charset=utf-8" http-equiv="Content-Type"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="black"/><link rel="apple-touch-icon" sizes="180x180" href="../ydoc/images/apple-touch-icon.png"/><link rel="icon" type="image/png" sizes="32x32" href="../ydoc/images/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="16x16" href="../ydoc/images/favicon-16x16.png"/><link rel="manifest" href="../ydoc/images/manifest.json"/><link rel="mask-icon" href="../ydoc/images/safari-pinned-tab.svg&quot;" color="#5bbad5"/><meta name="theme-color" content="#ffffff"/><meta http-equiv="Cache-Control" content="no-transform"/><meta http-equiv="Cache-Control" content="no-siteapp"/><title>内网部署</title><link rel="stylesheet" href="../ydoc/styles/style.css"/><meta name="author" content="ymfe"/><meta name="keywords" content="api管理,接口管理,接口文档,api文档"/><meta name="description" content="YApi 是高效、易用、功能强大的 api 管理平台，旨在为开发、产品、测试人员提供更优雅的接口管理服务。可以帮助开发者轻松创建、发布、维护 API，YApi 还为用户提供了优秀的交互体验，开发人员只需利用平台提供的接口数据写入工具以及简单的点击操作就可以实现接口的管理"/><meta id="releativePath" content=".."/><link rel="stylesheet" href="../ydoc/ydoc-plugin-search/search.css"/><link rel="stylesheet" href="../ydoc/ydoc-plugin-search/search.css"/></head><body><div class="g-doc"><div class="m-summary" id="js-menu"><div class="m-summary-content" id="js-menu-content"><div class="m-summary-block"><ul class="m-summary-list"><li class="item"><a href="index.html#%e5%ae%89%e8%a3%85" class="href">安装</a></li><li class="item"><a href="index.html#%e6%9c%8d%e5%8a%a1%e5%99%a8%e7%ae%a1%e7%90%86" class="href">服务器管理</a></li><li class="item"><a href="index.html#%e5%8d%87%e7%ba%a7" class="href">升级</a></li><li class="item"><a href="index.html#%e9%85%8d%e7%bd%aeldap%e7%99%bb%e5%bd%95" class="href">配置LDAP登录</a></li></ul></div></div><div class="m-summary-switch" id="js-summary-switch"><svg viewBox="0 0 926.23699 573.74994" version="1.1" x="0px" y="0px" width="15" height="15" class="bottom"><g transform="translate(904.92214,-879.1482)"><path d="m -673.67664,1221.6502 -231.2455,-231.24803 55.6165,-55.627 c 30.5891,-30.59485 56.1806,-55.627 56.8701,-55.627 0.6894,0 79.8637,78.60862 175.9427,174.68583 l 174.6892,174.6858 174.6892,-174.6858 c 96.079,-96.07721 175.253196,-174.68583 175.942696,-174.68583 0.6895,0 26.281,25.03215 56.8701,55.627 l 55.6165,55.627 -231.245496,231.24803 c -127.185,127.1864-231.5279,231.248 -231.873,231.248 -0.3451,0 -104.688,-104.0616 -231.873,-231.248 z" fill="#fff"></path></g></svg><svg viewBox="0 0 926.23699 573.74994" version="1.1" x="0px" y="0px" width="15" height="15" class="top"><g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="aaa" fill="#fff" fill-rule="nonzero"><path d="M231.2455,342.502 L0,111.25397 L55.6165,55.62697 C86.2056,25.03212 111.7971,-2.99999998e-05 112.4866,-2.99999998e-05 C113.176,-2.99999998e-05 192.3503,78.60859 288.4293,174.6858 L463.1185,349.3716 L637.8077,174.6858 C733.8867,78.60859 813.060896,-2.99999997e-05 813.750396,-2.99999997e-05 C814.439896,-2.99999997e-05 840.031396,25.03212 870.620496,55.62697 L926.236996,111.25397 L694.9915,342.502 C567.8065,469.6884 463.4636,573.75 463.1185,573.75 C462.7734,573.75 358.4305,469.6884 231.2455,342.502 Z" id="Shape" transform="translate(463.118498, 286.874985) scale(1, -1) translate(-463.118498, -286.874985) "></path></g></g></svg></div></div><div class="m-main" id="js-panel"><header class="m-header" id="js-header"><div class="m-header-title js-logo"><a href="../index.html" target="_self"><img class="logo" src="../documents/images/logo_header@2x.png"/><h6 class="name">YApi</h6></a></div><div><div class="m-search">
      <div class="icon">&#xf0fd;</div>
      <input type="text" class="input js-input" placeholder="搜索文档内容" />
      <div class="m-search-result js-search-result"></div>
    </div>
<div class="m-search">
      <div class="icon">&#xf0fd;</div>
      <input type="text" class="input js-input" placeholder="搜索文档内容" />
      <div class="m-search-result js-search-result"></div>
    </div></div><nav class="m-header-nav js-nav"><ul class="m-header-items"><li class="item "><a class="href" href="../documents/index.html">教程</a></li><li class="item active"><a class="href" href="">内网部署</a></li></ul></nav><div id="js-nav-btn" class="m-header-btn ui-font-ydoc"></div></header><div class="m-content" id="js-content"><div id="markdown-body" class="m-content-container markdown-body"><h1>&#x5185;&#x7F51;&#x90E8;&#x7F72;</h1>
<p>&#x4F7F;&#x7528;&#x6211;&#x4EEC;&#x63D0;&#x4F9B;&#x7684; yapi-cli &#x5DE5;&#x5177;&#xFF0C;&#x90E8;&#x7F72; YApi &#x5E73;&#x53F0;&#x662F;&#x975E;&#x5E38;&#x5BB9;&#x6613;&#x7684;&#x3002;&#x5EFA;&#x8BAE;&#x90E8;&#x7F72;&#x6210; http &#x7AD9;&#x70B9;&#xFF0C;&#x56E0; chrome &#x6D4F;&#x89C8;&#x5668;&#x5B89;&#x5168;&#x9650;&#x5236;&#xFF0C;&#x90E8;&#x7F72;&#x6210; https &#x4F1A;&#x5BFC;&#x81F4;&#x6D4B;&#x8BD5;&#x529F;&#x80FD;&#x5728;&#x8BF7;&#x6C42; http &#x7AD9;&#x70B9;&#x65F6;&#x6587;&#x4EF6;&#x4E0A;&#x4F20;&#x529F;&#x80FD;&#x5F02;&#x5E38;&#x3002;</p>
<p>&#x5982;&#x679C;&#x60A8;&#x662F;&#x5C06;&#x670D;&#x52A1;&#x5668;&#x4EE3;&#x7406;&#x5230; nginx &#x670D;&#x52A1;&#x5668;&#xFF0C;&#x8BF7;&#x914D;&#x7F6E; nginx &#x652F;&#x6301; websocket&#x3002;</p>
<pre><code>&#x5728;location /&#x6DFB;&#x52A0;
proxy_http_version 1.1;
proxy_set_header Upgrade $http_upgrade;
proxy_set_header Connection &quot;upgrade&quot;;
</code></pre>
<h2 id="&#x73AF;&#x5883;&#x8981;&#x6C42;">&#x73AF;&#x5883;&#x8981;&#x6C42;</h2>
<ul>
<li>nodejs&#xFF08;7.6+)</li>
<li>mongodb&#xFF08;2.6+&#xFF09;</li>
</ul>
<h2 id="&#x5B89;&#x88C5;">&#x5B89;&#x88C5;</h2>
<h3 id="&#x5B89;&#x88C5;-&#x65B9;&#x5F0F;&#x4E00;.-&#x53EF;&#x89C6;&#x5316;&#x90E8;&#x7F72;[&#x63A8;&#x8350;]">&#x65B9;&#x5F0F;&#x4E00;. &#x53EF;&#x89C6;&#x5316;&#x90E8;&#x7F72;[&#x63A8;&#x8350;]</h3>
<p>&#x6267;&#x884C; yapi server &#x542F;&#x52A8;&#x53EF;&#x89C6;&#x5316;&#x90E8;&#x7F72;&#x7A0B;&#x5E8F;&#xFF0C;&#x8F93;&#x5165;&#x76F8;&#x5E94;&#x7684;&#x914D;&#x7F6E;&#x548C;&#x70B9;&#x51FB;&#x5F00;&#x59CB;&#x90E8;&#x7F72;&#xFF0C;&#x5C31;&#x80FD;&#x5B8C;&#x6210;&#x6574;&#x4E2A;&#x7F51;&#x7AD9;&#x7684;&#x90E8;&#x7F72;&#x3002;&#x90E8;&#x7F72;&#x5B8C;&#x6210;&#x4E4B;&#x540E;&#xFF0C;&#x53EF;&#x6309;&#x7167;&#x63D0;&#x793A;&#x4FE1;&#x606F;&#xFF0C;&#x6267;&#x884C; node/{&#x7F51;&#x7AD9;&#x8DEF;&#x5F84;/server/app.js} &#x542F;&#x52A8;&#x670D;&#x52A1;&#x5668;&#x3002;&#x5728;&#x6D4F;&#x89C8;&#x5668;&#x6253;&#x5F00;&#x6307;&#x5B9A;url, &#x70B9;&#x51FB;&#x767B;&#x5F55;&#x8F93;&#x5165;&#x60A8;&#x521A;&#x624D;&#x8BBE;&#x7F6E;&#x7684;&#x7BA1;&#x7406;&#x5458;&#x90AE;&#x7BB1;&#xFF0C;&#x9ED8;&#x8BA4;&#x5BC6;&#x7801;(ymfe.org) &#x767B;&#x5F55;&#x7CFB;&#x7EDF;&#xFF08;&#x9ED8;&#x8BA4;&#x5BC6;&#x7801;&#x53EF;&#x5728;&#x4E2A;&#x4EBA;&#x4E2D;&#x5FC3;&#x4FEE;&#x6539;&#xFF09;&#x3002;</p>
<pre><code class="language-bash">npm install -g yapi-cli --registry https://registry.npm.taobao.org
yapi server
</code></pre>
<h3 id="&#x5B89;&#x88C5;-&#x65B9;&#x5F0F;&#x4E8C;.-&#x547D;&#x4EE4;&#x884C;&#x90E8;&#x7F72;">&#x65B9;&#x5F0F;&#x4E8C;. &#x547D;&#x4EE4;&#x884C;&#x90E8;&#x7F72;</h3>
<p>&#x5982;&#x679C; github &#x538B;&#x7F29;&#x6587;&#x4EF6;&#x65E0;&#x6CD5;&#x4E0B;&#x8F7D;&#xFF0C;&#x6216;&#x9700;&#x8981;&#x90E8;&#x7F72;&#x5230;&#x4E00;&#x4E9B;&#x7279;&#x6B8A;&#x7684;&#x670D;&#x52A1;&#x5668;&#xFF0C;&#x53EF;&#x5C1D;&#x8BD5;&#x6B64;&#x65B9;&#x6CD5;</p>
<pre><code class="language-bash">mkdir yapi
<span class="hljs-built_in">cd</span> yapi
git <span class="hljs-built_in">clone</span> https://github.com/YMFE/yapi.git vendors //&#x6216;&#x8005;&#x4E0B;&#x8F7D; zip &#x5305;&#x89E3;&#x538B;&#x5230; vendors &#x76EE;&#x5F55;
cp vendors/config_example.json ./config.json //&#x590D;&#x5236;&#x5B8C;&#x6210;&#x540E;&#x8BF7;&#x4FEE;&#x6539;&#x76F8;&#x5173;&#x914D;&#x7F6E;
<span class="hljs-built_in">cd</span> vendors
npm install --production --registry https://registry.npm.taobao.org
npm run install-server //&#x5B89;&#x88C5;&#x7A0B;&#x5E8F;&#x4F1A;&#x521D;&#x59CB;&#x5316;&#x6570;&#x636E;&#x5E93;&#x7D22;&#x5F15;&#x548C;&#x7BA1;&#x7406;&#x5458;&#x8D26;&#x53F7;&#xFF0C;&#x7BA1;&#x7406;&#x5458;&#x8D26;&#x53F7;&#x540D;&#x53EF;&#x5728; config.json &#x914D;&#x7F6E;
node server/app.js //&#x542F;&#x52A8;&#x670D;&#x52A1;&#x5668;&#x540E;&#xFF0C;&#x8BF7;&#x8BBF;&#x95EE; 127.0.0.1:{config.json&#x914D;&#x7F6E;&#x7684;&#x7AEF;&#x53E3;}&#xFF0C;&#x521D;&#x6B21;&#x8FD0;&#x884C;&#x4F1A;&#x6709;&#x4E2A;&#x7F16;&#x8BD1;&#x7684;&#x8FC7;&#x7A0B;&#xFF0C;&#x8BF7;&#x8010;&#x5FC3;&#x7B49;&#x5019;
</code></pre>
<p>&#x5B89;&#x88C5;&#x540E;&#x7684;&#x76EE;&#x5F55;&#x7ED3;&#x6784;&#x5982;&#x4E0B;&#xFF1A;</p>
<pre><code>|-- config.json
|-- init.lock
|-- log
`-- vendors
    |-- CHANGELOG.md
    |-- LICENSE
    |-- README.md
    |-- client
    |-- common
    |-- config_example.json
    |-- doc
    |-- exts
    |-- nodemon.json
    |-- npm-debug.log
    |-- package.json
    |-- plugin.json
    |-- server
    |-- static
    |-- test
    |-- webpack.alias.js
    |-- yapi-base-flow.jpg
    |-- ydocfile.js
    `-- ykit.config.js
</code></pre>
<h2 id="&#x670D;&#x52A1;&#x5668;&#x7BA1;&#x7406;">&#x670D;&#x52A1;&#x5668;&#x7BA1;&#x7406;</h2>
<p>&#x63A8;&#x8350;&#x4F7F;&#x7528; pm2 &#x7BA1;&#x7406; node &#x670D;&#x52A1;&#x5668;&#x542F;&#x52A8;&#xFF0C;&#x505C;&#x6B62;&#xFF0C;&#x5177;&#x4F53;&#x4F7F;&#x7528;&#x65B9;&#x6CD5;&#x53EF;&#x53C2;&#x8003;&#x4E0B;&#x9762;&#x7684;&#x6559;&#x7A0B;&#xFF1A;</p>
<ul>
<li><a href="http://pm2.keymetrics.io/docs/usage/quick-start/">&#x5B98;&#x7F51;&#x6587;&#x6863;</a></li>
<li><a href="http://imweb.io/topic/57c8cbb27f226f687b365636">PM2&#x5B9E;&#x7528;&#x5165;&#x95E8;&#x6307;&#x5357;</a></li>
</ul>
<h2 id="&#x5347;&#x7EA7;">&#x5347;&#x7EA7;</h2>
<p>&#x5347;&#x7EA7;&#x9879;&#x76EE;&#x7248;&#x672C;&#x662F;&#x975E;&#x5E38;&#x5BB9;&#x6613;&#x7684;&#xFF0C;&#x5E76;&#x4E14;&#x4E0D;&#x4F1A;&#x5F71;&#x54CD;&#x5DF2;&#x6709;&#x7684;&#x9879;&#x76EE;&#x6570;&#x636E;&#xFF0C;&#x53EA;&#x4F1A;&#x540C;&#x6B65; vendors &#x76EE;&#x5F55;&#x4E0B;&#x7684;&#x6E90;&#x7801;&#x6587;&#x4EF6;&#x3002;</p>
<pre><code>cd  {&#x9879;&#x76EE;&#x76EE;&#x5F55;}
yapi ls //&#x67E5;&#x770B;&#x7248;&#x672C;&#x53F7;&#x5217;&#x8868;
yapi update //&#x5347;&#x7EA7;&#x5230;&#x6700;&#x65B0;&#x7248;&#x672C;
yapi update -v v1.1.0 //&#x5347;&#x7EA7;&#x5230;&#x6307;&#x5B9A;&#x7248;&#x672C;
</code></pre>
<h2 id="&#x914D;&#x7F6E;&#x90AE;&#x7BB1;">&#x914D;&#x7F6E;&#x90AE;&#x7BB1;</h2>
<p>&#x6253;&#x5F00;&#x9879;&#x76EE;&#x76EE;&#x5F55; config.json &#x6587;&#x4EF6;&#xFF0C;&#x65B0;&#x589E; mail &#x914D;&#x7F6E;&#xFF0C; &#x66FF;&#x6362;&#x9ED8;&#x8BA4;&#x7684;&#x90AE;&#x7BB1;&#x914D;&#x7F6E;</p>
<pre><code>{
  &quot;port&quot;: &quot;*****&quot;,
  &quot;adminAccount&quot;: &quot;********&quot;,
  &quot;db&quot;: {...},
  &quot;mail&quot;: {
    &quot;enable&quot;: true,
    &quot;host&quot;: &quot;smtp.163.com&quot;,    //&#x90AE;&#x7BB1;&#x670D;&#x52A1;&#x5668;
    &quot;port&quot;: 465,               //&#x7AEF;&#x53E3;
    &quot;from&quot;: &quot;***@163.com&quot;,     //&#x53D1;&#x9001;&#x4EBA;&#x90AE;&#x7BB1;
    &quot;auth&quot;: {
        &quot;user&quot;: &quot;***@163.com&quot;, //&#x90AE;&#x7BB1;&#x670D;&#x52A1;&#x5668;&#x8D26;&#x53F7;
        &quot;pass&quot;: &quot;*****&quot;        //&#x90AE;&#x7BB1;&#x670D;&#x52A1;&#x5668;&#x5BC6;&#x7801;
    }
  }
}
</code></pre>
<p>&#x5982;&#x4F55;&#x7533;&#x8BF7;STMP&#x670D;&#x52A1;&#x5668;&#x8D26;&#x53F7;&#x548C;&#x5BC6;&#x7801;&#x53EF;&#x4EE5;&#x53C2;&#x8003;&#x4E0B;&#x9762;&#x7684;&#x6559;&#x7A0B;&#xFF1A;<a href="https://jingyan.baidu.com/article/fdbd42771da9b0b89e3f48a8.html">&#x5982;&#x4F55;&#x5F00;&#x901A;&#x7535;&#x5B50;&#x90AE;&#x7BB1;&#x7684;SMTP&#x529F;&#x80FD;</a></p>
<h2 id="&#x914D;&#x7F6E;ldap&#x767B;&#x5F55;">&#x914D;&#x7F6E;LDAP&#x767B;&#x5F55;</h2>
<p>&#x6253;&#x5F00;&#x9879;&#x76EE;&#x76EE;&#x5F55; config.json &#x6587;&#x4EF6;&#xFF0C;&#x6DFB;&#x52A0;&#x5982;&#x4E0B;&#x5B57;&#x6BB5;&#xFF1A;</p>
<pre><code>{
  &quot;port&quot;: &quot;*****&quot;,
  &quot;adminAccount&quot;: &quot;********&quot;,
  &quot;db&quot;: {...},
  &quot;mail&quot;: {...},
  &quot;ldapLogin&quot;: {
      &quot;enable&quot;: true,
      &quot;server&quot;: &quot;ldap://l-ldapt1.ops.dev.cn0.qunar.com&quot;,
      &quot;baseDn&quot;: &quot;CN=Admin,CN=Users,DC=test,DC=com&quot;,
      &quot;bindPassword&quot;: &quot;password123&quot;,
      &quot;searchDn&quot;: &quot;OU=UserContainer,DC=test,DC=com&quot;,
      &quot;searchStandard&quot;: &quot;mail&quot;
   }
}

</code></pre>
<p>&#x8FD9;&#x91CC;&#x9762;&#x7684;&#x914D;&#x7F6E;&#x9879;&#x542B;&#x4E49;&#x5982;&#x4E0B;&#xFF1A;</p>
<ul>
<li><code>enable</code> &#x8868;&#x793A;&#x662F;&#x5426;&#x914D;&#x7F6E; LDAP &#x767B;&#x5F55;&#xFF0C;true(&#x652F;&#x6301; LDAP&#x767B;&#x5F55; )/false(&#x4E0D;&#x652F;&#x6301;LDAP&#x767B;&#x5F55;);</li>
<li><code>server</code> LDAP &#x670D;&#x52A1;&#x5668;&#x5730;&#x5740;&#xFF0C;&#x524D;&#x9762;&#x9700;&#x8981;&#x52A0;&#x4E0A; ldap:// &#x524D;&#x7F00;&#xFF0C;&#x4E5F;&#x53EF;&#x4EE5;&#x662F; ldaps:// &#x8868;&#x793A;&#x662F;&#x901A;&#x8FC7; SSL &#x8FDE;&#x63A5;;</li>
<li><code>baseDn</code> LDAP &#x670D;&#x52A1;&#x5668;&#x7684;&#x767B;&#x5F55;&#x7528;&#x6237;&#x540D;&#xFF0C;&#x5FC5;&#x987B;&#x662F;&#x4ECE;&#x6839;&#x7ED3;&#x70B9;&#x5230;&#x7528;&#x6237;&#x8282;&#x70B9;&#x7684;&#x5168;&#x8DEF;&#x5F84;;</li>
<li><code>bindPassword</code> &#x767B;&#x5F55;&#x8BE5; LDAP &#x670D;&#x52A1;&#x5668;&#x7684;&#x5BC6;&#x7801;;</li>
<li><code>searchDn</code> &#x67E5;&#x8BE2;&#x7528;&#x6237;&#x6570;&#x636E;&#x7684;&#x8DEF;&#x5F84;&#xFF0C;&#x7C7B;&#x4F3C;&#x6570;&#x636E;&#x5E93;&#x4E2D;&#x7684;&#x4E00;&#x5F20;&#x8868;&#x7684;&#x5730;&#x5740;&#xFF0C;&#x6CE8;&#x610F;&#x8FD9;&#x91CC;&#x4E5F;&#x5FC5;&#x987B;&#x662F;&#x5168;&#x8DEF;&#x5F84;;</li>
<li><code>searchStandard</code> &#x67E5;&#x8BE2;&#x6761;&#x4EF6;&#xFF0C;&#x8FD9;&#x91CC;&#x662F; mail &#x8868;&#x793A;&#x67E5;&#x8BE2;&#x7528;&#x6237;&#x4FE1;&#x606F;&#x662F;&#x901A;&#x8FC7;&#x90AE;&#x7BB1;&#x4FE1;&#x606F;&#x6765;&#x67E5;&#x8BE2;&#x7684;&#x3002;&#x6CE8;&#x610F;&#xFF0C;&#x8BE5;&#x5B57;&#x6BB5;&#x4FE1;&#x606F;&#x4E0E;LDAP&#x6570;&#x636E;&#x5E93;&#x5B58;&#x50A8;&#x6570;&#x636E;&#x7684;&#x5B57;&#x6BB5;&#x76F8;&#x5BF9;&#x5E94;&#xFF0C;&#x5982;&#x679C;&#x5982;&#x679C;&#x5B58;&#x50A8;&#x7528;&#x6237;&#x90AE;&#x7BB1;&#x4FE1;&#x606F;&#x7684;&#x5B57;&#x6BB5;&#x662F; email,  &#x8FD9;&#x91CC;&#x5C31;&#x9700;&#x8981;&#x4FEE;&#x6539;&#x6210; email.</li>
</ul>
<p>&#x91CD;&#x542F;&#x670D;&#x52A1;&#x5668;&#x540E;&#xFF0C;&#x53EF;&#x4EE5;&#x5728;&#x767B;&#x5F55;&#x9875;&#x770B;&#x5230;&#x5982;&#x4E0B;&#x753B;&#x9762;&#xFF0C;&#x8BF4;&#x660E; ladp &#x914D;&#x7F6E;&#x6210;&#x529F;</p>
<img src="./ldap.png">
</div></div></div></div><script src="../ydoc/scripts/plugins/dollar.min.js"></script><script src="../ydoc/scripts/plugins/responsive-nav.min.js"></script><script src="../ydoc/scripts/plugins/slideout.min.js"></script><script src="../ydoc/scripts/app.js"></script><script src="../ydoc/ydoc-plugin-search/core.js"></script><script src="../ydoc/ydoc-plugin-search/search.js"></script><script src="../ydoc/ydoc-plugin-search/core.js"></script><script src="../ydoc/ydoc-plugin-search/search.js"></script><script src="../search_json.js"></script><script src="../search_json.js"></script></body></html>